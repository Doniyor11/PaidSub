import{a as ot,b as rt,c as E}from"./chunk-WHOWIM5M.js";import{a as it,b as nt,c as at}from"./chunk-I4XTAV2I.js";import{a as X}from"./chunk-OBFBONNI.js";import{S as B}from"./chunk-3NG3HV6R.js";import{d as et}from"./chunk-LXHW7I6Z.js";import"./chunk-VMU2RNMN.js";import{a as tt}from"./chunk-Z7EGFY67.js";import"./chunk-KNFDVZSQ.js";import"./chunk-R4Y7L4ET.js";import{$a as z,Ab as I,Cb as c,Db as _,Eb as C,Gb as G,Ia as g,Ka as l,P as L,Q as j,Ra as b,Rb as Y,Sa as y,Ta as P,Tb as Z,U as u,Ua as T,Va as a,Vb as H,Wa as s,Wb as q,Xa as d,Z as v,Zb as J,_ as $,_a as k,cb as U,db as f,fa as A,fc as K,ga as N,ha as M,hb as V,ic as O,kc as Q,lc as S,mc as W,ob as F,oc as w,pb as p,qb as m,rb as h,xa as o}from"./chunk-G7DRHVH5.js";import"./chunk-YHOLSLLF.js";var st=(()=>{let e=class e{constructor(){this.resourceUrl=W("stats"),this.http=u(J)}main(n){return this.http.get(`${this.resourceUrl}/botStats`,{params:this.convert(n)})}tariff(n,r){return this.http.get(`${this.resourceUrl}/tariffStats/${n}`,{params:this.convert(r)})}loadTariffStatistic(n,r){return this.http.get(`${this.resourceUrl}/tariffStats/${n}/subscriptionStats`,{params:this.convert(r)})}loadStatistic(n){return this.http.get(`${this.resourceUrl}/botStats/subscriptionStats`,{params:this.convert(n)})}convert(n){return Object.keys(n).forEach(r=>{n[r]||delete n[r]}),n}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=L({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var pt=t=>({currency:t});function _t(t,e){if(t&1&&(p(0),c(1,"dateRus")),t&2){let i=f(2);h(" ",C(1,1,i.firstDate,i.lastDate)," - ")}}function ut(t,e){if(t&1&&(a(0,"div",7),d(1,"info-button",19),a(2,"span",9),p(3),s(),a(4,"p",10),p(5),c(6,"translatePaid"),s()()),t&2){let i=f(2);o(3),m(i.stats.users_count),o(2),m(_(6,2,"stats_page__metric_users_count"))}}function gt(t,e){if(t&1&&(a(0,"div",7),d(1,"info-button",20),a(2,"span",9),p(3),s(),a(4,"p",10),p(5),c(6,"translatePaid"),s()()),t&2){let i=f(2);o(),l("isRight",!0),o(2),m(i.stats.inactive_users),o(2),m(_(6,3,"stats_page__metric_inactive_users"))}}function ht(t,e){t&1&&k(0)}function xt(t,e){if(t&1&&(a(0,"p"),p(1),g(2,ht,1,0,"ng-container",21),s()),t&2){let i=e.$implicit;f(2);let n=F(2);o(),h("",i.amount," "),o(),l("ngTemplateOutlet",n)("ngTemplateOutletContext",I(3,pt,i.currency))}}function vt(t,e){t&1&&k(0)}function Ct(t,e){if(t&1&&(a(0,"p"),p(1),g(2,vt,1,0,"ng-container",21),s()),t&2){let i=e.$implicit;f(2);let n=F(2);o(),h("",i.amount," "),o(),l("ngTemplateOutlet",n)("ngTemplateOutletContext",I(3,pt,i.currency))}}function St(t,e){t&1&&(a(0,"div",22)(1,"p"),p(2),c(3,"translatePaid"),s(),a(4,"span",23),M(),a(5,"svg",24),d(6,"path",25),s()()()),t&2&&(o(2),m(_(3,1,"stats_page__subs_stats__tariff_stats")))}function bt(t,e){if(t&1){let i=z();a(0,"div",2)(1,"div",3)(2,"p"),p(3),c(4,"translatePaid"),a(5,"a",4),g(6,_t,2,4),p(7),c(8,"dateRus"),s()()(),a(9,"div",5),g(10,ut,7,4,"div",6)(11,gt,7,5,"div",6),a(12,"div",7),d(13,"info-button",8),a(14,"span",9),p(15),s(),a(16,"p",10),p(17,"\u041A\u0443\u043F\u0438\u0432\u0448\u0438\u0445 \u043F\u043E\u0434\u043F\u0438\u0441\u043A\u0443"),s()(),a(18,"div",7),d(19,"info-button",11),a(20,"span",9),p(21),c(22,"mask"),s(),a(23,"p",10),p(24),c(25,"translatePaid"),s()(),a(26,"div",7),d(27,"info-button",12),a(28,"span",9),p(29),s(),a(30,"p",10),p(31),c(32,"translatePaid"),s()(),a(33,"div",7),d(34,"info-button",13),a(35,"div",14),P(36,xt,3,5,"p",null,y),s(),a(38,"p",10),p(39,"\u0414\u043E\u0445\u043E\u0434 \u043F\u0440\u043E\u0435\u043A\u0442\u0430"),s()()(),a(40,"div",15),d(41,"info-button",13),a(42,"div",14),P(43,Ct,3,5,"p",null,y),s(),a(45,"p",10),p(46),c(47,"translatePaid"),s()(),a(48,"div",3)(49,"p"),p(50),c(51,"translatePaid"),s()(),a(52,"div",16)(53,"statistica-grafig",17),U("params",function(r){A(i);let x=f();return N(x.params=r)}),s()(),g(54,St,7,3,"div",18),s()}if(t&2){let i=f();o(3),h(" ",_(4,18,"stats_page__period")," "),o(3),b(6,i.firstDate&&i.firstDate!==i.lastDate?6:-1),o(),h(" ",C(8,20,i.lastDate,i.firstDate),""),o(3),l("ngIf",!i.tariffId),o(),l("ngIf",!i.tariffId),o(4),m(i.tariffId?i.tariffStats.buyed_users_count:i.stats.buyed_subs_users_count),o(4),l("isRight",!0),o(2),h("",C(22,23,i.tariffId?i.tariffStats.cr:i.stats.cr,"separator.2"),"%"),o(3),m(_(25,26,"stats_page__metric_cr")),o(5),h("",i.tariffId?i.tariffStats.subscriber_lifetime_days:i.stats.subscription_lifetime_days," \u0434\u043D\u0435\u0439"),o(2),m(_(32,28,"stats_page__metric_subscription_lifetime_days")),o(3),l("isRight",!0),o(2),T(i.tariffId?i.tariffStats.income_stats:i.stats.income_stats),o(5),l("isRight",!0),o(2),T(i.tariffId?i.tariffStats.projected_income_stats:i.stats.projected_income_stats),o(3),m(_(47,30,"stats_page__metric_projected_income_stats")),o(4),m(_(51,32,"stats_page__subs_stats_section")),o(3),l("fields",i.fields)("statistics",i.data),o(),l("ngIf",!i.tariffId)}}function yt(t,e){t&1&&p(0," \u20BD ")}function Pt(t,e){t&1&&p(0," $ ")}function Tt(t,e){t&1&&p(0," \u20AC ")}function It(t,e){if(t&1&&g(0,yt,1,0)(1,Pt,1,0)(2,Tt,1,0),t&2){let i=e.currency,n=f();b(0,i===n.currencyType.RUB?0:i===n.currencyType.USD?1:2)}}var R=(()=>{let e=class e{constructor(){this.backButton=u(S),this.activatedRoute=u(K),this.statisticService=u(st),this.lastDate=new Date().getTime(),this.currencyType=at,this.columns=["active","count_gived_by_admin","count_trial_subs_users_count","not_prolong_users_count"],this.labels=["\u0410\u043A\u0442\u0438\u0432\u043D\u044B\u0445 \u043F\u043E\u0434\u043F\u0438\u0441\u043E\u043A","\u0412\u044B\u0434\u0430\u043D\u043E \u0430\u0434\u043C\u0438\u043D\u043E\u043C","\u041F\u043E\u0434\u043F\u0438\u0441\u0447\u0438\u043A\u0438 \u0441 \u0442\u0440\u0438\u0430\u043B \u043F\u0435\u0440\u0438\u043E\u0434\u043E\u043C","\u041D\u0435 \u043F\u0440\u043E\u0434\u043B\u0438\u0432\u0448\u0438\u0445 \u043F\u043E\u0434\u043F\u0438\u0441\u043A\u0443"],this.fields=[{column:"active",label:"stats_page__subs_stats__metric_active",color:"#4CC063"},{column:"count_gived_by_admin",label:"stats_page__subs_stats__metric_count_gived_by_admin",color:"#3178DE"},{column:"count_trial_subs_users_count",label:"stats_page__subs_stats__metric_count_trial_subs_users_count",color:"#F7931A"},{column:"not_prolong_users_count",label:"stats_page__subs_stats__metric_not_prolong_users_count",color:"#B84041"}]}ngOnInit(){this.backButton.getButton("/menu"),this.loadDate(),this.activatedRoute.params.subscribe(n=>{this.tariffId=n.id,this.checkLoad()})}checkLoad(){this.tariffId?(this.backButton.getButton("/statistic/tariffs"),this.loadTariffStats(),this.loadTariffStatistic()):(this.loadStats(),this.loadStatistic())}loadStats(){this.statisticService.main(this.params).subscribe(n=>{this.stats=n})}loadTariffStats(){this.statisticService.tariff(this.tariffId,this.params).subscribe(n=>{this.tariffStats=n})}loadDate(){let n=localStorage.getItem("statistic_"+it),r=localStorage.getItem("statistic_"+nt);n&&(this.lastDate=Number(n)),r&&(this.firstDate=Number(r))}loadStatistic(){this.loadFunc(this.statisticService.loadStatistic(this.params))}loadTariffStatistic(){this.loadFunc(this.statisticService.loadTariffStatistic(this.tariffId,this.params))}loadFunc(n){n.subscribe(r=>this.data=r)}get params(){return{start:this.firstDate,end:this.lastDate}}set params(n){this.firstDate=n.start,this.lastDate=n.end,this.checkLoad()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=v({type:e,selectors:[["ng-component"]],decls:3,vars:1,consts:[["amountType",""],["class","main","style","margin-bottom: 35px;",4,"ngIf"],[1,"main",2,"margin-bottom","35px"],[1,"title-text"],["href","javascript:void(0)","routerLink","/statistic/calendar"],[1,"white-containers"],["class","item",4,"ngIf"],[1,"item"],["text","help__buy_subs"],[1,"amount"],[1,"description"],["text","help__cr",3,"isRight"],["text","help__avg_lifetime"],["text","help__projected_income",3,"isRight"],[1,"price"],[1,"month-amount"],[1,"container-white"],[3,"params","fields","statistics"],["class","container-white position-relative","style","margin-top: 20px;","routerLink","tariffs/",4,"ngIf"],["text","help__started_bot"],["text","help__block_bot",3,"isRight"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["routerLink","tariffs/",1,"container-white","position-relative",2,"margin-top","20px"],[1,"right"],["width","7","height","12","viewBox","0 0 7 12","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M0.292893 10.2929C-0.0976311 10.6834 -0.0976311 11.3166 0.292893 11.7071C0.683418 12.0976 1.31658 12.0976 1.70711 11.7071L6.70711 6.70711C7.09763 6.31658 7.09763 5.68342 6.70711 5.29289L1.70711 0.292893C1.31658 -0.0976311 0.683418 -0.0976311 0.292893 0.292893C-0.0976311 0.683418 -0.0976311 1.31658 0.292893 1.70711L4.58579 6L0.292893 10.2929Z","fill","#3C3C43","fill-opacity","0.3"]],template:function(r,x){r&1&&g(0,bt,55,34,"div",1)(1,It,3,1,"ng-template",null,0,G),r&2&&l("ngIf",x.stats||x.tariffStats)},dependencies:[Y,Z,O,B,ot,rt,et,w],styles:[".white-containers[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap;gap:10px;width:calc(var(--width) + 40px)}.white-containers[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{width:calc(50% - 46px);background-color:#fff;border-radius:10px;min-height:70px;padding:14px 16px;position:relative}.white-containers[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{color:#636366;font-size:14px;line-height:18px}.white-containers[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%], .white-containers[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-size:19px;font-weight:500;line-height:22.67px;font-family:SF Pro Text,sans-serif}.white-containers[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:600}.about[_ngcontent-%COMP%]{position:absolute;right:10px;top:10px;cursor:pointer}.about[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{position:absolute;width:194px;top:20px;right:-119px;z-index:100;background-color:#000;color:#fff;border-radius:8px;line-height:20px;font-size:14px;padding:8px;display:none}.about[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{display:block}.about[_ngcontent-%COMP%]   .right-info[_ngcontent-%COMP%]{right:-13px}.month-amount[_ngcontent-%COMP%]{width:calc(var(--width) - 8px);background-color:#fff;border-radius:10px;min-height:70px;padding:14px 16px;position:relative;margin:30px 0}.month-amount[_ngcontent-%COMP%]   .about[_ngcontent-%COMP%]{position:absolute;right:10px;top:10px}.month-amount[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{color:#636366;font-size:14px;line-height:18px}.month-amount[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-size:19px;font-weight:600;line-height:22.67px;font-family:SF Pro Text,sans-serif}.title-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:19px;font-weight:600;line-height:22.27px}.title-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#007aff;text-decoration:none}"]});let t=e;return t})();var Mt=t=>({drop_date:t});function Ot(t,e){if(t&1&&(d(0,"p",5),c(1,"date")),t&2){let i=f().$implicit;l("params",I(4,Mt,C(1,1,i.drop_timestamp,"dd.MM.YYYY")))}}function wt(t,e){if(t&1&&(a(0,"p"),p(1),c(2,"translatePaid"),s()),t&2){let i=f().$implicit;o(),m(_(2,1,i.display_option))}}function Bt(t,e){if(t&1&&(a(0,"div",3)(1,"div",4)(2,"span"),p(3),s(),g(4,Ot,2,6,"p",5)(5,wt,3,3),s(),a(6,"span",6),M(),a(7,"svg",7),d(8,"path",8),s()()()),t&2){let i=e.$implicit;V("routerLink","/statistic/tariff/",i.id,""),o(3),m(i.name),o(),b(4,i.is_drop_marked?4:5)}}var ct=(()=>{let e=class e{constructor(){this.backButton=u(S),this.tariffService=u(X)}ngOnInit(){this.backButton.getButton("/statistic"),this.tariffService.tariff().subscribe(n=>{this.tariffs=n})}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=v({type:e,selectors:[["ng-component"]],decls:7,vars:3,consts:[[1,"main",2,"margin-bottom","20px"],[1,"title-text"],[2,"font-weight","600","font-size","19px","line-height","22.27px"],[1,"container-white","card",2,"margin","5px 0",3,"routerLink"],[1,"info"],["translatePaid","admin_panel_tariffs_page__tariff_marked_drop",2,"color","red",3,"params"],[1,"right"],["width","7","height","12","viewBox","0 0 7 12","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M0.292893 10.2929C-0.0976311 10.6834 -0.0976311 11.3166 0.292893 11.7071C0.683418 12.0976 1.31658 12.0976 1.70711 11.7071L6.70711 6.70711C7.09763 6.31658 7.09763 5.68342 6.70711 5.29289L1.70711 0.292893C1.31658 -0.0976311 0.683418 -0.0976311 0.292893 0.292893C-0.0976311 0.683418 -0.0976311 1.31658 0.292893 1.70711L4.58579 6L0.292893 10.2929Z","fill","#3C3C43","fill-opacity","0.3"]],template:function(r,x){r&1&&(a(0,"div",0)(1,"div",1)(2,"p",2),p(3),c(4,"translatePaid"),s()(),P(5,Bt,9,4,"div",3,y),s()),r&2&&(o(3),m(_(4,1,"stats_page__subs_stats__tariff_stats")),o(2),T(x.tariffs))},dependencies:[O,tt,H,w],styles:[".card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#8e8e93;font-size:14px}"]});let t=e;return t})();var mt=(()=>{let e=class e{constructor(){this.backButton=u(S)}ngOnInit(){this.backButton.getButton()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=v({type:e,selectors:[["ng-component"]],decls:1,vars:0,consts:[["entityName","statistic"]],template:function(r,x){r&1&&d(0,"calendar",0)},dependencies:[E],encapsulation:2});let t=e;return t})();var ve=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=$({type:e}),e.\u0275inj=j({imports:[q,Q.forChild([{path:"",component:R},{path:"tariffs",component:ct},{path:"tariff/:id",component:R},{path:"calendar",component:mt}]),E,B]});let t=e;return t})();export{ve as StatisticModule};
