import{a as E}from"./chunk-INW2X4BE.js";import{A as g,B as c,C as u,Ca as j,Da as k,E as C,Ea as D,F as p,G as N,Ia as G,J as f,K as O,Ka as U,L as S,M as P,Ma as $,N as l,O as s,P as m,Q as T,Qa as z,R as _,S as d,T as L,da as V,h as v,k as x,m as y,oa as b,t as M,u as w,v as h,w as F,za as I}from"./chunk-DTRIGQTD.js";var B=(()=>{let n=class n{constructor(){this.http=x(b),this.resourceUrl=E("marketing/uploadMedia")}create(t){return this.http.post(this.resourceUrl,t)}};n.\u0275fac=function(o){return new(o||n)},n.\u0275prov=v({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})();function Z(i,n){if(i&1&&m(0,"img",16),i&2){let r=d().$implicit;p("src",r.source_url,g)("alt",r.id)}}function q(i,n){if(i&1&&m(0,"video",17),i&2){let r=d().$implicit;p("src",r.source_url,g)}}function J(i,n){if(i&1){let r=T();l(0,"div",10)(1,"div",11),_("click",function(){let o=M(r).$implicit,e=d(2);return w(e.deleteMedia(o))}),h(),l(2,"svg",12),m(3,"circle",13)(4,"rect",14)(5,"rect",15),s()(),C(6,Z,1,2,"img",16)(7,q,1,1),s()}if(i&2){let r=n.$implicit;c(6),f(6,r.type===1?6:r.type===2?7:-1)}}function K(i,n){if(i&1&&(m(0,"div",8),l(1,"div",9),S(2,J,8,1,"div",10,O),s()),i&2){let r=d();c(2),P(r.medias)}}var ie=(()=>{let n=class n{constructor(t,o){this.controlContainer=t,this.mediaService=o,this.messageControlName="message",this.attachmentControlName="attachment",this.container=!0,this.medias=[]}ngOnInit(){this.editForm=this.controlContainer.control,setTimeout(()=>this.mediaChange(),1e3)}mediaChange(){let t=this.editForm.get(this.attachmentControlName);if(!t.value)t.setValue([]);else{let o=[];t.value.forEach(e=>{o.push(e.video??e.photo),this.medias.push({source_url:e.source_url,id:e.video??e.photo,type:e.type})}),t.setValue(o)}}generateType(t){return t.type.split("/")[0]==="image"?1:2}sendMedia(t){let o=new FormData;for(let e of t.target.files)o.append("media",e);this.mediaService.create(o).subscribe(e=>{for(let a=0;a<e.length;a++)this.medias.push({source_url:URL.createObjectURL(t.target.files[a]),id:e[a],type:this.generateType(t.target.files[a])});this.editForm.get(this.attachmentControlName).setValue([...this.editForm.get(this.attachmentControlName).value,...e])})}deleteMedia(t){let o=this.medias.indexOf(t),e=this.editForm.get(this.attachmentControlName).value;this.medias.splice(o,1),console.log(this.medias);for(let a=0;a<e.length;a++)e[a]===t.id&&(e.splice(a,1),a=e.length);this.editForm.get(this.attachmentControlName).setValue(e)}};n.\u0275fac=function(o){return new(o||n)(u(j),u(B))},n.\u0275cmp=y({type:n,selectors:[["media"]],inputs:{messageControlName:"messageControlName",attachmentControlName:"attachmentControlName",placeholder:"placeholder",container:"container"},standalone:!0,features:[V],decls:9,vars:8,consts:[[3,"formGroup"],[1,"position-relative"],["type","text",3,"placeholder","formControlName"],["for","upload-media"],[1,"right"],["xmlns","http://www.w3.org/2000/svg","width","28","height","28","viewBox","0 0 28 28","fill","none"],["d","M21.0811 16.096L15.7931 21.384C13.2589 23.9182 9.15018 23.9182 6.616 21.384C4.08181 18.8498 4.08181 14.7411 6.616 12.2069L13.7341 5.08883C15.4248 3.39808 18.1661 3.39808 19.8568 5.08883C21.5476 6.77957 21.5476 9.5208 19.8568 11.2115L12.5145 18.5539C11.7201 19.3483 10.4322 19.3483 9.63779 18.5539C8.84342 17.7595 8.84342 16.4716 9.63779 15.6772L15.1501 10.1649C15.43 9.88501 15.43 9.43115 15.1501 9.15122C14.8701 8.87129 14.4163 8.87129 14.1363 9.15122L8.62407 14.6635C7.26983 16.0177 7.26983 18.2134 8.62407 19.5676C9.9783 20.9219 12.174 20.9219 13.5282 19.5676L20.8705 12.2253C23.1211 9.97466 23.1211 6.32571 20.8705 4.0751C18.6199 1.82449 14.971 1.82449 12.7204 4.0751L5.60227 11.1932C2.50822 14.2872 2.50822 19.3037 5.60227 22.3977C8.69632 25.4918 13.7128 25.4918 16.8068 22.3977L22.0948 17.1097C22.3748 16.8298 22.3748 16.3759 22.0948 16.096C21.8149 15.8161 21.361 15.8161 21.0811 16.096Z","fill","#858E99"],["type","file","multiple","","id","upload-media","accept","image/*,video/*",3,"change"],[1,"line"],[1,"images"],[1,"image"],[1,"close",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 16 16","fill","none"],["cx","8","cy","8","r","7.5","fill","#3C3C43","fill-opacity","0.3","stroke","white"],["x","4.79297","y","4","width","10.4","height","1.12","rx","0.56","transform","rotate(45 4.79297 4)","fill","white"],["x","12.1465","y","4.79199","width","10.4","height","1.12","rx","0.56","transform","rotate(135 12.1465 4.79199)","fill","white"],[3,"src","alt"],[3,"src"]],template:function(o,e){o&1&&(l(0,"form",0)(1,"div",1),m(2,"input",2),l(3,"label",3)(4,"span",4),h(),l(5,"svg",5),m(6,"path",6),s()()(),F(),l(7,"input",7),_("change",function(R){return e.sendMedia(R)}),s()(),C(8,K,4,0),s()),o&2&&(N(e.container?"container-white":""),p("formGroup",e.editForm),c(2),L("placeholder","\u0422\u0435\u043A\u0441\u0442 ",e.placeholder,""),p("formControlName",e.messageControlName),c(6),f(8,e.medias&&e.medias.length>0?8:-1))},dependencies:[z,G,I,k,D,U,$],styles:[".images[_ngcontent-%COMP%]{display:flex;gap:8px}.images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;height:70px;width:70px}.images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;height:100%;object-fit:cover;border-radius:5px}.images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{position:absolute;right:4px;top:4px;z-index:100}#upload-media[_ngcontent-%COMP%]{display:none}"]});let i=n;return i})();export{ie as a};
