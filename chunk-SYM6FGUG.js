import{a as ct,b as A}from"./chunk-L77BIFEY.js";import{a as ot,b as rt,c as st}from"./chunk-I4XTAV2I.js";import{a as it}from"./chunk-OBFBONNI.js";import{S as L}from"./chunk-SQHWYEXA.js";import{d as at}from"./chunk-LXHW7I6Z.js";import"./chunk-JHVCJPUA.js";import{a as nt}from"./chunk-Z7EGFY67.js";import"./chunk-UYZEMZUS.js";import"./chunk-R4Y7L4ET.js";import{$a as D,Ab as x,Cb as p,Db as m,Eb as M,Gb as Z,Ia as v,Ka as d,Ob as Y,P as G,Q as z,Ra as E,Rb as q,Sa as k,Ta as O,Tb as J,U as C,Ua as B,Va as n,Vb as K,Wa as s,Wb as Q,Xa as u,Z as w,Zb as W,_ as H,_a as R,cb as b,db as l,fa as h,fc as X,ga as S,ha as g,hb as U,ia as y,ic as F,kc as tt,lc as I,mc as et,ob as N,oc as V,pb as c,qb as _,rb as f,xa as o}from"./chunk-G7DRHVH5.js";import"./chunk-YHOLSLLF.js";var pt=(()=>{let i=class i{constructor(){this.resourceUrl=et("stats"),this.http=C(W)}main(a){return this.http.get(`${this.resourceUrl}/botStats`,{params:this.convert(a)})}tariff(a,r){return this.http.get(`${this.resourceUrl}/tariffStats/${a}`,{params:this.convert(r)})}loadTariffStatistic(a,r){return this.http.get(`${this.resourceUrl}/tariffStats/${a}/subscriptionStats`,{params:this.convert(r)})}loadStatistic(a){return this.http.get(`${this.resourceUrl}/botStats/subscriptionStats`,{params:this.convert(a)})}convert(a){return Object.keys(a).forEach(r=>{a[r]||delete a[r]}),a}};i.\u0275fac=function(r){return new(r||i)},i.\u0275prov=G({token:i,factory:i.\u0275fac,providedIn:"root"});let t=i;return t})();var P=t=>({active:t}),lt=t=>({currency:t});function xt(t,i){if(t&1&&(c(0),p(1,"dateRus")),t&2){let e=l(2);f(" ",M(1,1,e.firstDate,e.lastDate)," - ")}}function Ct(t,i){if(t&1){let e=D();n(0,"div",7)(1,"div",8),b("click",function(){h(e);let r=l(2);return S(r.contentAbout="users_count")}),g(),n(2,"svg",9),u(3,"path",10),s(),y(),n(4,"div",11),c(5),p(6,"translatePaid"),s()(),n(7,"span",12),c(8),s(),n(9,"p",13),c(10),p(11,"translatePaid"),s()()}if(t&2){let e=l(2);o(4),d("ngClass",x(8,P,e.contentAbout==="users_count")),o(),f(" ",m(6,4,"help__started_bot")," "),o(3),_(e.stats.users_count),o(2),_(m(11,6,"stats_page__metric_users_count"))}}function gt(t,i){if(t&1){let e=D();n(0,"div",7)(1,"div",8),b("click",function(){h(e);let r=l(2);return S(r.contentAbout="inactive_users")}),g(),n(2,"svg",9),u(3,"path",10),s(),y(),n(4,"div",14),c(5),p(6,"translatePaid"),s()(),n(7,"span",12),c(8),s(),n(9,"p",13),c(10),p(11,"translatePaid"),s()()}if(t&2){let e=l(2);o(4),d("ngClass",x(8,P,e.contentAbout==="inactive_users")),o(),f(" ",m(6,4,"help__block_bot")," "),o(3),_(e.stats.inactive_users),o(2),_(m(11,6,"stats_page__metric_inactive_users"))}}function vt(t,i){t&1&&R(0)}function ht(t,i){if(t&1&&(n(0,"p"),c(1),v(2,vt,1,0,"ng-container",20),s()),t&2){let e=i.$implicit;l(2);let a=N(2);o(),f("",e.amount," "),o(),d("ngTemplateOutlet",a)("ngTemplateOutletContext",x(3,lt,e.currency))}}function St(t,i){t&1&&R(0)}function bt(t,i){if(t&1&&(n(0,"p"),c(1),v(2,St,1,0,"ng-container",20),s()),t&2){let e=i.$implicit;l(2);let a=N(2);o(),f("",e.amount," "),o(),d("ngTemplateOutlet",a)("ngTemplateOutletContext",x(3,lt,e.currency))}}function yt(t,i){t&1&&(n(0,"div",21)(1,"p"),c(2),p(3,"translatePaid"),s(),n(4,"span",22),g(),n(5,"svg",23),u(6,"path",24),s()()()),t&2&&(o(2),_(m(3,1,"stats_page__subs_stats__tariff_stats")))}function Tt(t,i){if(t&1){let e=D();n(0,"div",2)(1,"div",3)(2,"p"),c(3),p(4,"translatePaid"),n(5,"a",4),v(6,xt,2,4),c(7),p(8,"dateRus"),s()()(),n(9,"div",5),v(10,Ct,12,10,"div",6)(11,gt,12,10,"div",6),n(12,"div",7)(13,"div",8),b("click",function(){h(e);let r=l();return S(r.contentAbout="buyed_users")}),g(),n(14,"svg",9),u(15,"path",10),s(),y(),n(16,"div",11),c(17),p(18,"translatePaid"),s()(),n(19,"span",12),c(20),s(),n(21,"p",13),c(22,"\u041A\u0443\u043F\u0438\u0432\u0448\u0438\u0445 \u043F\u043E\u0434\u043F\u0438\u0441\u043A\u0443"),s()(),n(23,"div",7)(24,"div",8),b("click",function(){h(e);let r=l();return S(r.contentAbout="cr")}),g(),n(25,"svg",9),u(26,"path",10),s(),y(),n(27,"div",14),c(28),p(29,"translatePaid"),s()(),n(30,"span",12),c(31),p(32,"mask"),s(),n(33,"p",13),c(34),p(35,"translatePaid"),s()(),n(36,"div",7)(37,"div",8),b("click",function(){h(e);let r=l();return S(r.contentAbout="subscription_lifetime_days")}),g(),n(38,"svg",9),u(39,"path",10),s(),y(),n(40,"div",11),c(41),p(42,"translatePaid"),s()(),n(43,"span",12),c(44),s(),n(45,"p",13),c(46),p(47,"translatePaid"),s()(),n(48,"div",7)(49,"div",8),b("click",function(){h(e);let r=l();return S(r.contentAbout="income_stats")}),g(),n(50,"svg",9),u(51,"path",10),s(),y(),n(52,"div",14),c(53),p(54,"translatePaid"),s()(),n(55,"div",15),O(56,ht,3,5,"p",null,k),s(),n(58,"p",13),c(59,"\u0414\u043E\u0445\u043E\u0434 \u043F\u0440\u043E\u0435\u043A\u0442\u0430"),s()()(),n(60,"div",16)(61,"div",8),b("click",function(){h(e);let r=l();return S(r.contentAbout="projected_income_stats")}),g(),n(62,"svg",9),u(63,"path",10),s(),y(),n(64,"div",14),c(65),p(66,"translatePaid"),s()(),n(67,"div",15),O(68,bt,3,5,"p",null,k),s(),n(70,"p",13),c(71),p(72,"translatePaid"),s()(),n(73,"div",3)(74,"p"),c(75),p(76,"translatePaid"),s()(),n(77,"div",17)(78,"statistica-grafig",18),b("params",function(r){h(e);let T=l();return S(T.params=r)}),s()(),v(79,yt,7,3,"div",19),s()}if(t&2){let e=l();o(3),f(" ",m(4,25,"stats_page__period")," "),o(3),E(6,e.firstDate&&e.firstDate!==e.lastDate?6:-1),o(),f(" ",M(8,27,e.lastDate,e.firstDate),""),o(3),d("ngIf",!e.tariffId),o(),d("ngIf",!e.tariffId),o(5),d("ngClass",x(51,P,e.contentAbout==="buyed_users")),o(),f(" ",m(18,30,"help__buy_subs")," "),o(3),_(e.tariffId?e.tariffStats.buyed_users_count:e.stats.buyed_subs_users_count),o(7),d("ngClass",x(53,P,e.contentAbout==="cr")),o(),f(" ",m(29,32,"help__cr")," "),o(3),f("",M(32,34,e.tariffId?e.tariffStats.cr:e.stats.cr,"separator.2"),"%"),o(3),_(m(35,37,"stats_page__metric_cr")),o(6),d("ngClass",x(55,P,e.contentAbout==="subscription_lifetime_days")),o(),f(" ",m(42,39,"help__avg_lifetime")," "),o(3),f("",e.tariffId?e.tariffStats.subscriber_lifetime_days:e.stats.subscription_lifetime_days," \u0434\u043D\u0435\u0439"),o(2),_(m(47,41,"stats_page__metric_subscription_lifetime_days")),o(6),d("ngClass",x(57,P,e.contentAbout==="income_stats")),o(),f(" ",m(54,43,"help__projected_income")," "),o(3),B(e.tariffId?e.tariffStats.income_stats:e.stats.income_stats),o(8),d("ngClass",x(59,P,e.contentAbout==="projected_income_stats")),o(),f(" ",m(66,45,"help__avg_lifetime")," "),o(3),B(e.tariffId?e.tariffStats.projected_income_stats:e.stats.projected_income_stats),o(3),_(m(72,47,"stats_page__metric_projected_income_stats")),o(4),_(m(76,49,"stats_page__subs_stats_section")),o(3),d("fields",e.fields)("statistics",e.data),o(),d("ngIf",!e.tariffId)}}function Pt(t,i){t&1&&c(0," \u20BD ")}function wt(t,i){t&1&&c(0," $ ")}function Mt(t,i){t&1&&c(0," \u20AC ")}function It(t,i){if(t&1&&v(0,Pt,1,0)(1,wt,1,0)(2,Mt,1,0),t&2){let e=i.currency,a=l();E(0,e===a.currencyType.RUB?0:e===a.currencyType.USD?1:2)}}var $=(()=>{let i=class i{constructor(){this.backButton=C(I),this.activatedRoute=C(X),this.statisticService=C(pt),this.lastDate=new Date().getTime(),this.currencyType=st,this.columns=["active","count_gived_by_admin","count_trial_subs_users_count","not_prolong_users_count"],this.labels=["\u0410\u043A\u0442\u0438\u0432\u043D\u044B\u0445 \u043F\u043E\u0434\u043F\u0438\u0441\u043E\u043A","\u0412\u044B\u0434\u0430\u043D\u043E \u0430\u0434\u043C\u0438\u043D\u043E\u043C","\u041F\u043E\u0434\u043F\u0438\u0441\u0447\u0438\u043A\u0438 \u0441 \u0442\u0440\u0438\u0430\u043B \u043F\u0435\u0440\u0438\u043E\u0434\u043E\u043C","\u041D\u0435 \u043F\u0440\u043E\u0434\u043B\u0438\u0432\u0448\u0438\u0445 \u043F\u043E\u0434\u043F\u0438\u0441\u043A\u0443"],this.fields=[{column:"active",label:"stats_page__subs_stats__metric_active",color:"#4CC063"},{column:"count_gived_by_admin",label:"stats_page__subs_stats__metric_count_gived_by_admin",color:"#3178DE"},{column:"count_trial_subs_users_count",label:"stats_page__subs_stats__metric_count_trial_subs_users_count",color:"#F7931A"},{column:"not_prolong_users_count",label:"stats_page__subs_stats__metric_not_prolong_users_count",color:"#B84041"}]}ngOnInit(){this.backButton.getButton("/menu"),this.loadDate(),this.activatedRoute.params.subscribe(a=>{this.tariffId=a.id,this.checkLoad()})}checkLoad(){this.tariffId?(this.backButton.getButton("/statistic/tariffs"),this.loadTariffStats(),this.loadTariffStatistic()):(this.loadStats(),this.loadStatistic())}loadStats(){this.statisticService.main(this.params).subscribe(a=>{this.stats=a})}loadTariffStats(){this.statisticService.tariff(this.tariffId,this.params).subscribe(a=>{this.tariffStats=a})}loadDate(){let a=localStorage.getItem("statistic_"+ot),r=localStorage.getItem("statistic_"+rt);a&&(this.lastDate=Number(a)),r&&(this.firstDate=Number(r))}loadStatistic(){this.loadFunc(this.statisticService.loadStatistic(this.params))}loadTariffStatistic(){this.loadFunc(this.statisticService.loadTariffStatistic(this.tariffId,this.params))}loadFunc(a){a.subscribe(r=>this.data=r)}get params(){return{start:this.firstDate,end:this.lastDate}}set params(a){this.firstDate=a.start,this.lastDate=a.end,this.checkLoad()}};i.\u0275fac=function(r){return new(r||i)},i.\u0275cmp=w({type:i,selectors:[["ng-component"]],decls:3,vars:1,consts:[["amountType",""],["class","main","style","margin-bottom: 35px;",4,"ngIf"],[1,"main",2,"margin-bottom","35px"],[1,"title-text"],["href","javascript:void(0)","routerLink","/statistic/calendar"],[1,"white-containers"],["class","item",4,"ngIf"],[1,"item"],[1,"about",3,"click"],["width","16","height","16","viewBox","0 0 16 16","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M8.92308 12C8.92308 12.1826 8.86894 12.361 8.76751 12.5128C8.66608 12.6646 8.52192 12.7829 8.35325 12.8528C8.18458 12.9227 7.99898 12.941 7.81992 12.9053C7.64086 12.8697 7.47638 12.7818 7.34729 12.6527C7.21819 12.5236 7.13028 12.3591 7.09466 12.1801C7.05904 12.001 7.07732 11.8154 7.14719 11.6468C7.21706 11.4781 7.33537 11.3339 7.48717 11.2325C7.63897 11.1311 7.81743 11.0769 8 11.0769C8.24482 11.0769 8.4796 11.1742 8.65271 11.3473C8.82583 11.5204 8.92308 11.7552 8.92308 12ZM8 3.69231C6.30308 3.69231 4.92308 4.93461 4.92308 6.46154V6.76923C4.92308 6.93244 4.98791 7.08896 5.10332 7.20437C5.21873 7.31978 5.37525 7.38461 5.53846 7.38461C5.70167 7.38461 5.8582 7.31978 5.97361 7.20437C6.08901 7.08896 6.15385 6.93244 6.15385 6.76923V6.46154C6.15385 5.61538 6.98231 4.92308 8 4.92308C9.01769 4.92308 9.84616 5.61538 9.84616 6.46154C9.84616 7.30769 9.01769 8 8 8C7.83679 8 7.68027 8.06483 7.56486 8.18024C7.44945 8.29565 7.38462 8.45217 7.38462 8.61538V9.23077C7.38462 9.39398 7.44945 9.5505 7.56486 9.66591C7.68027 9.78132 7.83679 9.84615 8 9.84615C8.16321 9.84615 8.31974 9.78132 8.43514 9.66591C8.55055 9.5505 8.61539 9.39398 8.61539 9.23077V9.17538C10.0185 8.91769 11.0769 7.79846 11.0769 6.46154C11.0769 4.93461 9.69692 3.69231 8 3.69231ZM16 8C16 9.58225 15.5308 11.129 14.6518 12.4446C13.7727 13.7602 12.5233 14.7855 11.0615 15.391C9.59966 15.9965 7.99113 16.155 6.43928 15.8463C4.88743 15.5376 3.46197 14.7757 2.34315 13.6569C1.22433 12.538 0.462403 11.1126 0.153721 9.56072C-0.15496 8.00887 0.00346628 6.40034 0.608967 4.93853C1.21447 3.47672 2.23985 2.22729 3.55544 1.34824C4.87103 0.469192 6.41775 0 8 0C10.121 0.00223986 12.1546 0.845814 13.6544 2.34562C15.1542 3.84542 15.9978 5.87895 16 8ZM14.7692 8C14.7692 6.66117 14.3722 5.35241 13.6284 4.23922C12.8846 3.12602 11.8274 2.25839 10.5905 1.74605C9.35356 1.2337 7.99249 1.09965 6.67939 1.36084C5.36629 1.62203 4.16013 2.26674 3.21343 3.21343C2.26674 4.16012 1.62203 5.36629 1.36084 6.67939C1.09965 7.99249 1.2337 9.35356 1.74605 10.5905C2.2584 11.8274 3.12603 12.8846 4.23922 13.6284C5.35241 14.3722 6.66117 14.7692 8 14.7692C9.79469 14.7672 11.5153 14.0534 12.7843 12.7843C14.0534 11.5153 14.7672 9.79468 14.7692 8Z","fill","black","fill-opacity","0.3"],[1,"content",3,"ngClass"],[1,"amount"],[1,"description"],[1,"content","right-info",3,"ngClass"],[1,"price"],[1,"month-amount"],[1,"container-white"],[3,"params","fields","statistics"],["class","container-white position-relative","style","margin-top: 20px;","routerLink","tariffs/",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["routerLink","tariffs/",1,"container-white","position-relative",2,"margin-top","20px"],[1,"right"],["width","7","height","12","viewBox","0 0 7 12","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M0.292893 10.2929C-0.0976311 10.6834 -0.0976311 11.3166 0.292893 11.7071C0.683418 12.0976 1.31658 12.0976 1.70711 11.7071L6.70711 6.70711C7.09763 6.31658 7.09763 5.68342 6.70711 5.29289L1.70711 0.292893C1.31658 -0.0976311 0.683418 -0.0976311 0.292893 0.292893C-0.0976311 0.683418 -0.0976311 1.31658 0.292893 1.70711L4.58579 6L0.292893 10.2929Z","fill","#3C3C43","fill-opacity","0.3"]],template:function(r,T){r&1&&v(0,Tt,80,61,"div",1)(1,It,3,1,"ng-template",null,0,Z),r&2&&d("ngIf",T.stats||T.tariffStats)},dependencies:[Y,q,J,F,L,ct,at,V],styles:[".white-containers[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap;gap:10px;width:calc(var(--width) + 40px)}.white-containers[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{width:calc(50% - 46px);background-color:#fff;border-radius:10px;min-height:70px;padding:14px 16px;position:relative}.white-containers[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{color:#636366;font-size:14px;line-height:18px}.white-containers[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%], .white-containers[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-size:19px;font-weight:500;line-height:22.67px;font-family:SF Pro Text,sans-serif}.white-containers[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:600}.about[_ngcontent-%COMP%]{position:absolute;right:10px;top:10px;cursor:pointer}.about[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{position:absolute;width:194px;top:20px;right:-119px;z-index:100;background-color:#000;color:#fff;border-radius:8px;line-height:20px;font-size:14px;padding:8px;display:none}.about[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{display:block}.about[_ngcontent-%COMP%]   .right-info[_ngcontent-%COMP%]{right:-13px}.month-amount[_ngcontent-%COMP%]{width:calc(var(--width) - 8px);background-color:#fff;border-radius:10px;min-height:70px;padding:14px 16px;position:relative;margin:30px 0}.month-amount[_ngcontent-%COMP%]   .about[_ngcontent-%COMP%]{position:absolute;right:10px;top:10px}.month-amount[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{color:#636366;font-size:14px;line-height:18px}.month-amount[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-size:19px;font-weight:600;line-height:22.67px;font-family:SF Pro Text,sans-serif}.title-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:19px;font-weight:600;line-height:22.27px}.title-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#007aff;text-decoration:none}"]});let t=i;return t})();var Et=t=>({drop_date:t});function kt(t,i){if(t&1&&(u(0,"p",5),p(1,"date")),t&2){let e=l().$implicit;d("params",x(4,Et,M(1,1,e.drop_timestamp,"dd.MM.YYYY")))}}function Ot(t,i){if(t&1&&(n(0,"p"),c(1),p(2,"translatePaid"),s()),t&2){let e=l().$implicit;o(),_(m(2,1,e.display_option))}}function Bt(t,i){if(t&1&&(n(0,"div",3)(1,"div",4)(2,"span"),c(3),s(),v(4,kt,2,6,"p",5)(5,Ot,3,3),s(),n(6,"span",6),g(),n(7,"svg",7),u(8,"path",8),s()()()),t&2){let e=i.$implicit;U("routerLink","/statistic/tariff/",e.id,""),o(3),_(e.name),o(),E(4,e.is_drop_marked?4:5)}}var mt=(()=>{let i=class i{constructor(){this.backButton=C(I),this.tariffService=C(it)}ngOnInit(){this.backButton.getButton("/statistic"),this.tariffService.tariff().subscribe(a=>{this.tariffs=a})}};i.\u0275fac=function(r){return new(r||i)},i.\u0275cmp=w({type:i,selectors:[["ng-component"]],decls:7,vars:3,consts:[[1,"main",2,"margin-bottom","20px"],[1,"title-text"],[2,"font-weight","600","font-size","19px","line-height","22.27px"],[1,"container-white","card",2,"margin","5px 0",3,"routerLink"],[1,"info"],["translatePaid","admin_panel_tariffs_page__tariff_marked_drop",2,"color","red",3,"params"],[1,"right"],["width","7","height","12","viewBox","0 0 7 12","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M0.292893 10.2929C-0.0976311 10.6834 -0.0976311 11.3166 0.292893 11.7071C0.683418 12.0976 1.31658 12.0976 1.70711 11.7071L6.70711 6.70711C7.09763 6.31658 7.09763 5.68342 6.70711 5.29289L1.70711 0.292893C1.31658 -0.0976311 0.683418 -0.0976311 0.292893 0.292893C-0.0976311 0.683418 -0.0976311 1.31658 0.292893 1.70711L4.58579 6L0.292893 10.2929Z","fill","#3C3C43","fill-opacity","0.3"]],template:function(r,T){r&1&&(n(0,"div",0)(1,"div",1)(2,"p",2),c(3),p(4,"translatePaid"),s()(),O(5,Bt,9,4,"div",3,k),s()),r&2&&(o(3),_(m(4,1,"stats_page__subs_stats__tariff_stats")),o(2),B(T.tariffs))},dependencies:[F,nt,K,V],styles:[".card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#8e8e93;font-size:14px}"]});let t=i;return t})();var dt=(()=>{let i=class i{constructor(){this.backButton=C(I)}ngOnInit(){this.backButton.getButton()}};i.\u0275fac=function(r){return new(r||i)},i.\u0275cmp=w({type:i,selectors:[["ng-component"]],decls:1,vars:0,consts:[["entityName","statistic"]],template:function(r,T){r&1&&u(0,"calendar",0)},dependencies:[A],encapsulation:2});let t=i;return t})();var ge=(()=>{let i=class i{};i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=H({type:i}),i.\u0275inj=z({imports:[Q,tt.forChild([{path:"",component:$},{path:"tariffs",component:mt},{path:"tariff/:id",component:$},{path:"calendar",component:dt}]),A,L]});let t=i;return t})();export{ge as StatisticModule};
