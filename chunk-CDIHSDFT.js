import{a as st,b as pt,c as E}from"./chunk-EUR2Z5TS.js";import{a as at,b as ot,c as rt}from"./chunk-I4XTAV2I.js";import{a as et}from"./chunk-JEGG4O73.js";import{a as B}from"./chunk-PIYXEI6K.js";import{d as nt}from"./chunk-FHYSYJCX.js";import"./chunk-YJWMZDQW.js";import{a as it}from"./chunk-GPXLMJ5J.js";import"./chunk-WTANOLED.js";import{g as L}from"./chunk-LAM3YWTL.js";import{$a as Z,A as v,B as N,Ba as R,Ca as p,Da as m,Ea as x,I as z,J as U,K as I,Na as M,Pa as c,Qa as u,Ra as C,Sa as Y,U as o,aa as g,bb as H,ca as l,cb as q,eb as J,gb as K,ja as b,ka as y,la as P,lb as Q,ma as T,na as a,nb as W,oa as r,ob as O,pa as d,qa as F,qb as X,ra as V,rb as S,sa as D,sb as tt,ta as _,u as $,ub as w,v as A,va as G,y as f}from"./chunk-VXXFJJRS.js";import"./chunk-CWTPBX7D.js";var ct=(()=>{let e=class e{constructor(){this.resourceUrl=tt("stats"),this.http=f(K)}main(n){return this.http.get(`${this.resourceUrl}/botStats`,{params:this.convert(n)})}tariff(n,s){return this.http.get(`${this.resourceUrl}/tariffStats/${n}`,{params:this.convert(s)})}loadTariffStatistic(n,s){return L(this.http.get(`${this.resourceUrl}/tariffStats/${n}/subscriptionStats`,{params:this.convert(s)}))}loadStatistic(n){return L(this.http.get(`${this.resourceUrl}/botStats/subscriptionStats`,{params:this.convert(n)}))}convert(n){return Object.keys(n).forEach(s=>{n[s]||delete n[s]}),n}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=$({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var mt=t=>({currency:t});function gt(t,e){if(t&1&&(p(0),c(1,"dateRus")),t&2){let i=_(2);x(" ",C(1,1,i.firstDate,i.lastDate)," - ")}}function xt(t,e){if(t&1&&(a(0,"div",7),d(1,"info-button",19),a(2,"span",9),p(3),r(),a(4,"p",10),p(5),c(6,"translatePaid"),r()()),t&2){let i=_(2);o(3),m(i.stats.users_count),o(2),m(u(6,2,"stats_page__metric_users_count"))}}function vt(t,e){if(t&1&&(a(0,"div",7),d(1,"info-button",20),a(2,"span",9),p(3),r(),a(4,"p",10),p(5),c(6,"translatePaid"),r()()),t&2){let i=_(2);o(),l("isRight",!0),o(2),m(i.stats.inactive_users),o(2),m(u(6,3,"stats_page__metric_inactive_users"))}}function Ct(t,e){t&1&&F(0)}function St(t,e){if(t&1&&(a(0,"p"),p(1),g(2,Ct,1,0,"ng-container",21),r()),t&2){let i=e.$implicit;_(2);let n=R(2);o(),x("",i.amount," "),o(),l("ngTemplateOutlet",n)("ngTemplateOutletContext",M(3,mt,i.currency))}}function bt(t,e){t&1&&F(0)}function yt(t,e){if(t&1&&(a(0,"p"),p(1),g(2,bt,1,0,"ng-container",21),r()),t&2){let i=e.$implicit;_(2);let n=R(2);o(),x("",i.amount," "),o(),l("ngTemplateOutlet",n)("ngTemplateOutletContext",M(3,mt,i.currency))}}function Pt(t,e){t&1&&(a(0,"div",22)(1,"p"),p(2),c(3,"translatePaid"),r(),a(4,"span",23),I(),a(5,"svg",24),d(6,"path",25),r()()()),t&2&&(o(2),m(u(3,1,"stats_page__subs_stats__tariff_stats")))}function Tt(t,e){if(t&1){let i=V();a(0,"div",2)(1,"div",3)(2,"p"),p(3),c(4,"translatePaid"),a(5,"a",4),g(6,gt,2,4),p(7),c(8,"dateRus"),r()()(),a(9,"div",5),g(10,xt,7,4,"div",6)(11,vt,7,5,"div",6),a(12,"div",7),d(13,"info-button",8),a(14,"span",9),p(15),r(),a(16,"p",10),p(17,"\u041A\u0443\u043F\u0438\u0432\u0448\u0438\u0445 \u043F\u043E\u0434\u043F\u0438\u0441\u043A\u0443"),r()(),a(18,"div",7),d(19,"info-button",11),a(20,"span",9),p(21),c(22,"mask"),r(),a(23,"p",10),p(24),c(25,"translatePaid"),r()(),a(26,"div",7),d(27,"info-button",12),a(28,"span",9),p(29),r(),a(30,"p",10),p(31),c(32,"translatePaid"),r()(),a(33,"div",7),d(34,"info-button",13),a(35,"div",14),P(36,St,3,5,"p",null,y),r(),a(38,"p",10),p(39,"\u0414\u043E\u0445\u043E\u0434 \u043F\u0440\u043E\u0435\u043A\u0442\u0430"),r()()(),a(40,"div",15),d(41,"info-button",13),a(42,"div",14),P(43,yt,3,5,"p",null,y),r(),a(45,"p",10),p(46),c(47,"translatePaid"),r()(),a(48,"div",3)(49,"p"),p(50),c(51,"translatePaid"),r()(),a(52,"div",16)(53,"statistica-grafig",17),D("params",function(s){z(i);let h=_();return U(h.params=s)}),r()(),g(54,Pt,7,3,"div",18),r()}if(t&2){let i=_();o(3),x(" ",u(4,18,"stats_page__period")," "),o(3),b(6,i.firstDate&&i.firstDate!==i.lastDate?6:-1),o(),x(" ",C(8,20,i.lastDate,i.firstDate),""),o(3),l("ngIf",!i.tariffId),o(),l("ngIf",!i.tariffId),o(4),m(i.tariffId?i.tariffStats.buyed_users_count:i.stats.buyed_subs_users_count),o(4),l("isRight",!0),o(2),x("",C(22,23,i.tariffId?i.tariffStats.cr:i.stats.cr,"separator.2"),"%"),o(3),m(u(25,26,"stats_page__metric_cr")),o(5),x("",i.tariffId?i.tariffStats.subscriber_lifetime_days:i.stats.subscription_lifetime_days," \u0434\u043D\u0435\u0439"),o(2),m(u(32,28,"stats_page__metric_subscription_lifetime_days")),o(3),l("isRight",!0),o(2),T(i.tariffId?i.tariffStats.income_stats:i.stats.income_stats),o(5),l("isRight",!0),o(2),T(i.tariffId?i.tariffStats.projected_income_stats:i.stats.projected_income_stats),o(3),m(u(47,30,"stats_page__metric_projected_income_stats")),o(4),m(u(51,32,"stats_page__subs_stats_section")),o(3),l("fields",i.fields)("statistics",i.data),o(),l("ngIf",!i.tariffId)}}function Mt(t,e){t&1&&p(0," \u20BD ")}function It(t,e){t&1&&p(0," $ ")}function Dt(t,e){t&1&&p(0," \u20AC ")}function Ot(t,e){if(t&1&&g(0,Mt,1,0)(1,It,1,0)(2,Dt,1,0),t&2){let i=e.currency,n=_();b(0,i===n.currencyType.RUB?0:i===n.currencyType.USD?1:2)}}var j=(()=>{let e=class e{constructor(){this.backButton=f(S),this.activatedRoute=f(Q),this.statisticService=f(ct),this.lastDate=new Date().getTime(),this.currencyType=rt,this.columns=["active","count_gived_by_admin","count_trial_subs_users_count","not_prolong_users_count"],this.fields=[{column:"active",label:"stats_page__subs_stats__metric_active",color:"#4CC063"},{column:"count_gived_by_admin",label:"stats_page__subs_stats__metric_count_gived_by_admin",color:"#3178DE"},{column:"count_trial_subs_users_count",label:"stats_page__subs_stats__metric_count_trial_subs_users_count",color:"#F7931A"},{column:"not_prolong_users_count",label:"stats_page__subs_stats__metric_not_prolong_users_count",color:"#B84041"}]}ngOnInit(){this.backButton.getButton("/menu"),this.loadDate(),this.activatedRoute.params.subscribe(n=>{this.tariffId=n.id,this.checkLoad()})}checkLoad(){this.tariffId?(this.backButton.getButton("/statistic/tariffs"),this.loadTariffStats(),this.loadTariffStatistic()):(this.loadStats(),this.loadStatistic())}loadStats(){this.statisticService.main(this.params).subscribe(n=>{this.stats=n})}loadTariffStats(){this.statisticService.tariff(this.tariffId,this.params).subscribe(n=>{this.tariffStats=n})}loadDate(){let n=new Date;n.setDate(1),this.firstDate=n.getTime();let s=this.activatedRoute.snapshot.paramMap.get(at),h=this.activatedRoute.snapshot.paramMap.get(ot);s&&(this.lastDate=Number(s)),h&&(this.firstDate=Number(h))}loadStatistic(){this.loadFunc(this.statisticService.loadStatistic(this.params))}loadTariffStatistic(){this.loadFunc(this.statisticService.loadTariffStatistic(this.tariffId,this.params))}loadFunc(n){n.subscribe(s=>this.data=s)}get params(){return{start:this.firstDate,end:this.lastDate}}set params(n){this.firstDate=n.start,this.lastDate=n.end,this.checkLoad()}};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=v({type:e,selectors:[["ng-component"]],decls:3,vars:1,consts:[["amountType",""],["class","main","style","margin-bottom: 35px;",4,"ngIf"],[1,"main",2,"margin-bottom","35px"],[1,"title-text"],["href","javascript:void(0)","routerLink","/statistic/calendar"],[1,"white-containers"],["class","item",4,"ngIf"],[1,"item"],["text","help__buy_subs"],[1,"amount"],[1,"description"],["text","help__cr",3,"isRight"],["text","help__avg_lifetime"],["text","help__projected_income",3,"isRight"],[1,"price"],[1,"month-amount"],[1,"container-white"],[3,"params","fields","statistics"],["class","container-white position-relative","style","margin-top: 20px;","routerLink","tariffs/",4,"ngIf"],["text","help__started_bot"],["text","help__block_bot",3,"isRight"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["routerLink","tariffs/",1,"container-white","position-relative",2,"margin-top","20px"],[1,"right"],["width","7","height","12","viewBox","0 0 7 12","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M0.292893 10.2929C-0.0976311 10.6834 -0.0976311 11.3166 0.292893 11.7071C0.683418 12.0976 1.31658 12.0976 1.70711 11.7071L6.70711 6.70711C7.09763 6.31658 7.09763 5.68342 6.70711 5.29289L1.70711 0.292893C1.31658 -0.0976311 0.683418 -0.0976311 0.292893 0.292893C-0.0976311 0.683418 -0.0976311 1.31658 0.292893 1.70711L4.58579 6L0.292893 10.2929Z","fill","#3C3C43","fill-opacity","0.3"]],template:function(s,h){s&1&&g(0,Tt,55,34,"div",1)(1,Ot,3,1,"ng-template",null,0,Y),s&2&&l("ngIf",h.stats||h.tariffStats)},dependencies:[Z,H,O,B,st,pt,nt,w],styles:[".white-containers[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap;gap:10px;width:calc(var(--width) + 40px)}.white-containers[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{width:calc(50% - 46px);background-color:#fff;border-radius:10px;min-height:70px;padding:14px 16px;position:relative}.white-containers[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{color:#636366;font-size:14px;line-height:18px}.white-containers[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%], .white-containers[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-size:19px;font-weight:500;line-height:22.67px;font-family:SF Pro Text,sans-serif}.white-containers[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:600}.about[_ngcontent-%COMP%]{position:absolute;right:10px;top:10px;cursor:pointer}.about[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{position:absolute;width:194px;top:20px;right:-119px;z-index:100;background-color:#000;color:#fff;border-radius:8px;line-height:20px;font-size:14px;padding:8px;display:none}.about[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{display:block}.about[_ngcontent-%COMP%]   .right-info[_ngcontent-%COMP%]{right:-13px}.month-amount[_ngcontent-%COMP%]{width:calc(var(--width) - 8px);background-color:#fff;border-radius:10px;min-height:70px;padding:14px 16px;position:relative;margin:30px 0}.month-amount[_ngcontent-%COMP%]   .about[_ngcontent-%COMP%]{position:absolute;right:10px;top:10px}.month-amount[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{color:#636366;font-size:14px;line-height:18px}.month-amount[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-size:19px;font-weight:600;line-height:22.67px;font-family:SF Pro Text,sans-serif}.title-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:19px;font-weight:600;line-height:22.27px}.title-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#007aff;text-decoration:none}"]});let t=e;return t})();var wt=t=>({drop_date:t});function Bt(t,e){if(t&1&&(d(0,"p",5),c(1,"date")),t&2){let i=_().$implicit;l("params",M(4,wt,C(1,1,i.drop_timestamp,"dd.MM.YYYY")))}}function Et(t,e){if(t&1&&(a(0,"p"),p(1),c(2,"translatePaid"),r()),t&2){let i=_().$implicit;o(),m(u(2,1,i.display_option))}}function kt(t,e){if(t&1&&(a(0,"div",3)(1,"div",4)(2,"span"),p(3),r(),g(4,Bt,2,6,"p",5)(5,Et,3,3),r(),a(6,"span",6),I(),a(7,"svg",7),d(8,"path",8),r()()()),t&2){let i=e.$implicit;G("routerLink","/statistic/tariff/",i.id,""),o(3),m(i.name),o(),b(4,i.is_drop_marked?4:5)}}var lt=(()=>{let e=class e{constructor(){this.backButton=f(S),this.tariffService=f(et)}ngOnInit(){this.backButton.getButton("/statistic"),this.tariffService.tariff().subscribe(n=>{this.tariffs=n})}};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=v({type:e,selectors:[["ng-component"]],decls:7,vars:3,consts:[[1,"main",2,"margin-bottom","20px"],[1,"title-text"],[2,"font-weight","600","font-size","19px","line-height","22.27px"],[1,"container-white","card",2,"margin","5px 0",3,"routerLink"],[1,"info"],["translatePaid","admin_panel_tariffs_page__tariff_marked_drop",2,"color","red",3,"params"],[1,"right"],["width","7","height","12","viewBox","0 0 7 12","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M0.292893 10.2929C-0.0976311 10.6834 -0.0976311 11.3166 0.292893 11.7071C0.683418 12.0976 1.31658 12.0976 1.70711 11.7071L6.70711 6.70711C7.09763 6.31658 7.09763 5.68342 6.70711 5.29289L1.70711 0.292893C1.31658 -0.0976311 0.683418 -0.0976311 0.292893 0.292893C-0.0976311 0.683418 -0.0976311 1.31658 0.292893 1.70711L4.58579 6L0.292893 10.2929Z","fill","#3C3C43","fill-opacity","0.3"]],template:function(s,h){s&1&&(a(0,"div",0)(1,"div",1)(2,"p",2),p(3),c(4,"translatePaid"),r()(),P(5,kt,9,4,"div",3,y),r()),s&2&&(o(3),m(u(4,1,"stats_page__subs_stats__tariff_stats")),o(2),T(h.tariffs))},dependencies:[O,it,q,w],styles:[".card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#8e8e93;font-size:14px}"]});let t=e;return t})();var ft=(()=>{let e=class e{constructor(){this.backButton=f(S),this.router=f(W)}ngOnInit(){this.backButton.getFunc(()=>this.goBack())}goBack(){this.router.navigate(["/statistic",{lastDate:this.lastDate,firstDate:this.firstDate}])}changeDate(n){this.lastDate=n.lastDate,this.firstDate=n.firstDate}};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=v({type:e,selectors:[["ng-component"]],decls:1,vars:0,consts:[[3,"changeDate"]],template:function(s,h){s&1&&(a(0,"calendar",0),D("changeDate",function(dt){return h.changeDate(dt)}),r())},dependencies:[E],encapsulation:2});let t=e;return t})();var Te=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=N({type:e}),e.\u0275inj=A({imports:[J,X.forChild([{path:"",component:j},{path:"tariffs",component:lt},{path:"tariff/:id",component:j},{path:"calendar",component:ft}]),E,B]});let t=e;return t})();export{Te as StatisticModule};
